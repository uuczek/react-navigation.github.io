<!DOCTYPE html><html lang="zh-Hans"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Redux 集成 · React Navigation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;有些人喜欢将他们的 navigation state 存储在与其他的应用程序的 state 相同的位置。 Using Redux to store your state enables you to write custom actions that manipulate the navigation state directly, to be able to dispatch navigation actions from anywhere (sometimes in a &amp;quot;thunk&amp;quot; or &amp;quot;saga&amp;quot;) and to persist the navigation state in the same way you would other Redux state (your mileage may vary on this). You can read more about other use cases in the replies to &lt;a href=&quot;https://twitter.com/satya164/status/952291726521024512&quot;&gt;this tweet&lt;/a&gt;.&lt;/p&gt;
"/><meta name="docsearch:version" content="1.x"/><meta name="docsearch:language" content="zh-Hans"/><meta property="og:title" content="Redux 集成 · React Navigation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://reactnavigation.org/index.html"/><meta property="og:description" content="&lt;p&gt;有些人喜欢将他们的 navigation state 存储在与其他的应用程序的 state 相同的位置。 Using Redux to store your state enables you to write custom actions that manipulate the navigation state directly, to be able to dispatch navigation actions from anywhere (sometimes in a &amp;quot;thunk&amp;quot; or &amp;quot;saga&amp;quot;) and to persist the navigation state in the same way you would other Redux state (your mileage may vary on this). You can read more about other use cases in the replies to &lt;a href=&quot;https://twitter.com/satya164/status/952291726521024512&quot;&gt;this tweet&lt;/a&gt;.&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css"/><link rel="alternate" type="application/atom+xml" href="https://reactnavigation.org/blog/atom.xml" title="React Navigation Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://reactnavigation.org/blog/feed.xml" title="React Navigation Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-10128745-16', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-Hans"><img class="logo" src="/img/spiro_white.svg" alt="React Navigation"/><h2 class="headerTitleWithLogo">React Navigation</h2></a><a href="/zh-Hans/versions.html"><h3>1.x</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/zh-Hans/1.x/getting-started.html" target="_self">Docs</a></li><li class=""><a href="/docs/zh-Hans/1.x/api-reference.html" target="_self">API</a></li><li class=""><a href="/zh-Hans/help.html" target="_self">Help</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/1.x/redux-integration.html">English</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>How do I do ...?</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Fundamentals</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/getting-started.html">入门</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/hello-react-navigation.html">React Navigation 简介</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/navigating.html">页面切换</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/params.html">传递参数给路由</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/headers.html">配置标题栏</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/header-buttons.html">标题栏按钮</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/modal.html">打开全屏模式</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/next-steps.html">下一步</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/glossary-of-terms.html">专业术语</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">How do I do ...?</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/tab-based-navigation.html">Tab navigation</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/drawer-based-navigation.html">Drawer navigation</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/auth-flow.html">身份验证流程</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/handling-iphonex.html">适配 iPhone X</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/status-bar.html">基于路由的不同状态栏配置</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/custom-android-back-button-handling.html">自定义 Android Back 键的行为</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/connecting-navigation-prop.html">从任何组件访问 navigation prop</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/navigating-without-navigation-prop.html">在没有 navigation 这个 prop 的情况下进行页面跳转</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/deep-linking.html">深度链接</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/screen-tracking.html">页面追踪</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/zh-Hans/1.x/redux-integration.html">Redux 集成</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Build your own Navigator</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/custom-navigator-overview.html">概述</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/routers.html">路由</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/custom-navigators.html">自定义 navigator</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/custom-routers.html">自定义路由</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/navigation-views.html">导航视图</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/transitioner.html">转场动画</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Meta</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/pitch.html">Pitch &amp; anti-pitch</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/alternatives.html">可选库</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/1.x/contributing.html">Contributing</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/react-navigation/react-navigation.github.io/edit/source/docs/redux-integration.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Redux 集成</h1></header><article><div><span><p>有些人喜欢将他们的 navigation state 存储在与其他的应用程序的 state 相同的位置。 Using Redux to store your state enables you to write custom actions that manipulate the navigation state directly, to be able to dispatch navigation actions from anywhere (sometimes in a &quot;thunk&quot; or &quot;saga&quot;) and to persist the navigation state in the same way you would other Redux state (your mileage may vary on this). You can read more about other use cases in the replies to <a href="https://twitter.com/satya164/status/952291726521024512">this tweet</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="warning"></a><a href="#warning" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Warning!</h2>
<p><em>You probably do not need to do this!</em> Storing your React Navigation state in your own Redux store is likely to give you a very difficult time if you don't know what you're doing. You lose out on some performance optimizations that React Navigation can do for you, for example. Please do not integrate your state into Redux without first ensuring that you can do what you need to do without it!</p>
<h2><a class="anchor" aria-hidden="true" id="概述"></a><a href="#概述" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>概述</h2>
<ol>
<li><p>To handle your app's navigation state in Redux, you can pass your own <code>navigation</code> prop to a navigator.</p></li>
<li><p>Once you pass your own navigation prop to the navigator, the default <a href="https://reactnavigation.org/docs/navigation-prop"><code>navigation</code></a> prop gets destroyed. You must construct your own <code>navigation</code> prop with <a href="https://reactnavigation.org/docs/navigation-prop#state-the-screen-s-current-state-route"><code>state</code></a>, <a href="https://reactnavigation.org/docs/navigation-prop#dispatch-send-an-action-to-the-router"><code>dispatch</code></a>, and <code>addListener</code> properties.</p></li>
<li><p>The <code>state</code> will be fed from the reducer assigned to handle navigation state and the <code>dispatch</code> will be Redux's default <code>dispatch</code>. Thus you will be able to dispatch normal redux actions using <code>this.props.navigation.dispatch(ACTION)</code>, reducer will update the navigation state on the basis of dispatched action, the new navigation state will then be passed to the navigator.</p></li>
<li><p>A middleware is needed so that any events that mutate the navigation state properly trigger the event listeners.</p></li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="手把手教学"></a><a href="#手把手教学" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>手把手教学</h2>
<p>首先，你需要将<code>react-navigation-redux-helpers</code>添加项目中。</p>
<pre><code class="hljs">bash
  yarn add react-navigation-redux-helpers
</code></pre>
<p>或</p>
<pre><code class="hljs">bash
  npm install --save react-navigation-redux-helpers
</code></pre>
<p>With Redux, your app's state is defined by a reducer. Each navigation router effectively has a reducer, called <code>getStateForAction</code>. 以下是如何在 Redux 应用程序中使用导航器的最简单示例：</p>
<pre><code class="hljs css language-es6">import {
  StackNavigator,
  addNavigationHelpers,
} <span class="hljs-keyword">from</span> 'react-navigation';
import {
  createStore,
  applyMiddleware,
  combineReducers,
} <span class="hljs-keyword">from</span> 'redux';
import {
  createReduxBoundAddListener,
  createReactNavigationReduxMiddleware,
} <span class="hljs-keyword">from</span> 'react-navigation-redux-helpers';
import { Provider, connect } <span class="hljs-keyword">from</span> 'react-redux';
import React <span class="hljs-keyword">from</span> 'react';

const AppNavigator = StackNavigator(AppRouteConfigs);

const initialState = AppNavigator.router.getStateForAction(AppNavigator.router.getActionForPathAndParams('Login'));

const navReducer = (<span class="hljs-keyword">state</span> = initialState, action) =&gt; {
  const nextState = AppNavigator.router.getStateForAction(action, <span class="hljs-keyword">state</span>);

  // Simply return the original `<span class="hljs-keyword">state</span>` if `nextState` is null or undefined.
  return nextState || <span class="hljs-keyword">state</span>;
};

const appReducer = combineReducers({
  nav: navReducer,
  ...
});

// Note: createReactNavigationReduxMiddleware must be run before createReduxBoundAddListener
const middleware = createReactNavigationReduxMiddleware(
  <span class="hljs-string">"root"</span>,
  <span class="hljs-keyword">state</span> =&gt; <span class="hljs-keyword">state</span>.nav,
);
const addListener = createReduxBoundAddListener(<span class="hljs-string">"root"</span>);

class App extends React.Component {
  render() {
    return (
      <span class="hljs-variable">&lt;AppNavigator navigation={addNavigationHelpers({
        dispatch: this.props.dispatch,
        state: this.props.nav,
        addListener,
      })} /&gt;</span>
    );
  }
}

const mapStateToProps = (<span class="hljs-keyword">state</span>) =&gt; ({
  nav: <span class="hljs-keyword">state</span>.nav
});

const AppWithNavigationState = connect(mapStateToProps)(App);

const store = createStore(
  appReducer,
  applyMiddleware(middleware),
);

class Root extends React.Component {
  render() {
    return (
      <span class="hljs-variable">&lt;Provider store={store}&gt;</span>
        <span class="hljs-variable">&lt;AppWithNavigationState /&gt;</span>
      &lt;/Provider&gt;
    );
  }
}
</code></pre>
<p>一旦你这样做，你的 navigation state 就会被存储在你的 Redux store 中，这时，你就可以使用 Redux 的调度功能来触发导航操作。</p>
<p>请记住，当导航器被赋予一个<code>navigation</code> prop 时，它将放弃对其内部 state 的控制。 这意味着现在由你负责维护其 state，处理任何深度链接，<a href="#handling-the-hardware-back-button-in-android">处理 Android 中的物理返回键 </a>等。</p>
<p>Navigation state 在嵌套时会自动从一个导航器传递到另一个导航器。 请注意，为了让子导航器接收父导航器的 state，应将其定义为<code>screen</code>。</p>
<p>将此应用于上面的示例中，你可以改为定义一个<code>AppNavigator</code>以包含嵌套的<code>TabNavigator</code>，如下所示：</p>
<pre><code class="hljs css language-es6"><span class="hljs-attribute">const AppNavigator</span> = StackNavigator({
  Home: { screen: MyTabNavigator },
});
</code></pre>
<p>在这种情况下，一旦你将<code>AppNavigator `` connect</code>到 Redux，就像<code>AppWithNavigationState</code>中所做的那样，<code>MyTabNavigator</code>将自动能够像访问<code>navigation</code> prop 一样访问 navigation state。</p>
<h2><a class="anchor" aria-hidden="true" id="完整示例"></a><a href="#完整示例" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>完整示例</h2>
<p>如果你想自己尝试，这里有个使用 Redux 的<a href="https://github.com/react-community/react-navigation/tree/master/examples/ReduxExample">示例应用</a>。</p>
<h2><a class="anchor" aria-hidden="true" id="mock-测试"></a><a href="#mock-测试" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mock 测试</h2>
<p>To make jest tests work with your react-navigation app, you need to change the jest preset in the <code>package.json</code>, see <a href="https://facebook.github.io/jest/docs/tutorial-react-native.html#transformignorepatterns-customization">here</a>:</p>
<pre><code class="hljs css language-json">"jest": {
  "preset": "react-native",
  "transformIgnorePatterns": [
    "node_modules/(?!(jest-)?react-native|react-navigation)"
  ]
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="处理-android-中的物理返回键"></a><a href="#处理-android-中的物理返回键" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>处理 Android 中的物理返回键</h2>
<p>通过使用以下代码片段，你的导航组件将能够监听点击物理返回键的操作，并且会正确地与你的堆栈进行交互。 这在 Android 上非常有用。</p>
<pre><code class="hljs css language-es6"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { BackHandler } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-native"</span>;
<span class="hljs-keyword">import</span> { addNavigationHelpers, NavigationActions } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-navigation"</span>;

<span class="hljs-keyword">const</span> AppNavigation = TabNavigator(
  {
    <span class="hljs-attr">Home</span>: { <span class="hljs-attr">screen</span>: HomeScreen },
    <span class="hljs-attr">Settings</span>: { <span class="hljs-attr">screen</span>: SettingScreen }
  }
);

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReduxNavigation</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  componentDidMount() {
    BackHandler.addEventListener(<span class="hljs-string">"hardwareBackPress"</span>, <span class="hljs-keyword">this</span>.onBackPress);
  }
  componentWillUnmount() {
    BackHandler.removeEventListener(<span class="hljs-string">"hardwareBackPress"</span>, <span class="hljs-keyword">this</span>.onBackPress);
  }
  onBackPress = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> { dispatch, nav } = <span class="hljs-keyword">this</span>.props;
    <span class="hljs-keyword">if</span> (nav.index === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    dispatch(NavigationActions.back());
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  };

  render() {
    <span class="hljs-keyword">const</span> { dispatch, nav } = <span class="hljs-keyword">this</span>.props;
    <span class="hljs-keyword">const</span> navigation = addNavigationHelpers({
      dispatch,
      <span class="hljs-attr">state</span>: nav,
      addListener,
    });

    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppNavigation</span> <span class="hljs-attr">navigation</span>=<span class="hljs-string">{navigation}</span> /&gt;</span>;
  }
}
</span></code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/zh-Hans/1.x/screen-tracking.html"><span class="arrow-prev">← </span><span>页面追踪</span></a><a class="docs-next button" href="/docs/zh-Hans/1.x/custom-navigator-overview.html"><span>概述</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#warning">Warning!</a></li><li><a href="#概述">概述</a></li><li><a href="#手把手教学">手把手教学</a></li><li><a href="#完整示例">完整示例</a></li><li><a href="#mock-测试">Mock 测试</a></li><li><a href="#处理-android-中的物理返回键">处理 Android 中的物理返回键</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/spiro_white.svg" alt="React Navigation" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/zh-Hans/getting-started.html">Getting Started</a><a href="/docs/zh-Hans/api-reference.html">API Reference</a><a href="/docs/zh-Hans/custom-navigator-overview.html">Building your own Navigator</a><a href="/docs/zh-Hans/contributing.html">Contributing</a></div><div><h5>Support</h5><a href="https://discord.gg/4xEK3nD">Chat in our Discord channel</a><a href="https://react-navigation.canny.io/feature-requests">Request a feature on Canny</a><a href="https://github.com/react-navigation/react-navigation/issues">Report a bug on Github</a><a href="https://stackoverflow.com/questions/tagged/react-navigation" target="_blank">Get help on Stack Overflow</a></div><div><h5>More</h5><a href="https://github.com/react-navigation/react-navigation">GitHub</a><a class="github-button" href="https://github.com/react-navigation/react-navigation" data-icon="octicon-star" data-count-href="/react-community/react-navigation/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'c967b4a1491b9cb486d3dca087b771e6',
                indexName: 'reactnavigation',
                inputSelector: '#search_input_react'
              });
            </script></body></html>